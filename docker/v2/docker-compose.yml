version: '3'
services:
  nexus:
    build: nexus
    ports:
     - "8081:8081"
    container_name: "javacloud-nexus"
  jenkins:
    build: jenkins
    ports:
     - "8082:8082"
    container_name: "javacloud-jenkins"
  alpine-java:
    build: alpine-java
    container_name: "javacloud-deployments"
  mysql:
    build: mysql
    container_name: "javacloud-mysql"   
  mongodb:
    build: mongodb
    ports:
     - "27017:27017"
    container_name: "javacloud-mongodb"
  gitlab:
    build: gitlab
    ports:
    - "8083:8083"
    - "8322:8322"
    environment:
      GITLAB_OMNIBUS_CONFIG: |    
        external_url "http://#{host}/gitlab"
        nginx['listen_port'] = 8083
        gitlab_rails['gitlab_shell_ssh_port'] = 8322
    container_name: "javacloud-gitlab"
  redis:
    image: "redis:alpine"
    container_name: "javacloud-redis"   
  webconsole:
    build: webconsole
    ports:
     - "8080:8080"    
    container_name: "javacloud-webconsole"
